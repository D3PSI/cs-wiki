<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Threads and Synchronization</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-opaquegray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="8eed6a72-8f09-4eb6-ab36-96275989e0c2" class="page sans"><header><div class="page-header-icon undefined"><span class="icon">🧵</span></div><h1 class="page-title">Threads and Synchronization</h1></header><div class="page-body"><nav id="bd30d087-f682-40e2-af37-eea5cf8a43b2" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#34208aff-6b92-4e51-97d2-c309759e4c4e">Multitasking</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#4968224e-2ae6-47fd-a3f2-e36e6d2f3540">Processes/Multiprocessing</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#f244046c-ec8c-453c-a349-3ecfe6e30231">Process Context</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#25a9b54c-13b3-4fad-902d-181b3a036693">Process Lifecycle</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#631eca9a-3d7b-486f-9ec3-855ac18baead">Process Management</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#766ed0a7-82e8-49af-bf66-cce9ae3db8bc">Process Control Block (PCB)</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#37b6a614-3820-4225-896f-6751d829f975">Threads/Multithreading</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#742f2b01-7250-475e-82f6-fc76606b101b">Multithreading: 1 vs. many CPUs</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#a29269bb-4497-4780-bbf7-f7b22ded06be">Java Threads</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#d35a19e4-e368-4da9-82b7-618686e939ac">Creating Java Threads</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#d8e8760f-f49d-444d-a07a-68deb79b240e">Thread State Model in Java</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#a9f7b55a-5852-4eec-ab3c-2230c648f64c"><code>java.lang.Thread</code> (under the hood)</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#10f88e42-01a1-45cc-abb3-4ee0b05c4ca2">Java Threads: Some Key Points</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#1d4cc540-344a-4843-9bcf-4cc3cd49e60c">Java Threads: Some Useful Attributes and Methods</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#40cdece0-0e24-433b-bfc4-33090f196f16">Joining Java Threads</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#6046aca0-1c44-45e6-90d8-fcee28394e41">Exceptions</a></div></nav><h1 id="34208aff-6b92-4e51-97d2-c309759e4c4e" class="">Multitasking</h1><p id="4856cbe0-61cb-4796-ad5c-07119ec6fd8f" class="">Multitasking describes the concurrent execution of multiple tasks or processes. It is achieved via time multiplexing of the CPU, which creates an impression of parallelism even on a single-core system. Multitasking allows for asynchronous I/O.</p><h1 id="4968224e-2ae6-47fd-a3f2-e36e6d2f3540" class="">Processes/Multiprocessing</h1><p id="00100709-d011-4577-9496-74b41c8395a1" class="">A process is essentially a program executing inside an OS. Each running instance of a program (e.g., multiple browser windows) is a separate process. Multiple processes can be run in parallel. Each process has a context:</p><h2 id="f244046c-ec8c-453c-a349-3ecfe6e30231" class="">Process Context</h2><ul id="a2f43b33-c0a6-4777-89df-dbff69b91305" class="bulleted-list"><li style="list-style-type:disc">Instruction counter/pointer</li></ul><ul id="6673729b-3c24-49da-9a02-c6746a51d2b2" class="bulleted-list"><li style="list-style-type:disc">Values in registers, stack and heap</li></ul><ul id="16bd7871-dbeb-4080-afa5-45dbef5bce4d" class="bulleted-list"><li style="list-style-type:disc">Resource handles (device access, open files)</li></ul><ul id="00ba8231-4fe7-4056-9f74-f804e0738a2e" class="bulleted-list"><li style="list-style-type:disc">...</li></ul><h2 id="25a9b54c-13b3-4fad-902d-181b3a036693" class="">Process Lifecycle</h2><p id="2ec05bfc-2654-4ccc-89cc-0f84a1b85628" class="">A process can have the following states:</p><ul id="b5b213be-3842-4b5d-bf44-be4b778c511f" class="bulleted-list"><li style="list-style-type:disc">Created</li></ul><ul id="91632ac6-01fa-4b6e-a53b-fff49bcaf1f8" class="bulleted-list"><li style="list-style-type:disc">Waiting</li></ul><ul id="0cb750f5-129d-4315-bebe-76f64d1276d9" class="bulleted-list"><li style="list-style-type:disc">Running</li></ul><ul id="2c7c4f0e-f3a2-4ece-a0ec-3c11a0e33ea5" class="bulleted-list"><li style="list-style-type:disc">Blocked (waiting for e.g., I/O)</li></ul><ul id="9d390a57-59a2-4d53-b5ae-f9c4c793b6dd" class="bulleted-list"><li style="list-style-type:disc">Terminated</li></ul><figure id="4b47feff-376a-4134-b71e-55be6a4282a7" class="image"><a href="Threads%20and%20Synchronization%208eed6a728f094eb6ab3696275989e0c2/2022-03-05_14-55.png"><img style="width:672px" src="Threads%20and%20Synchronization%208eed6a728f094eb6ab3696275989e0c2/2022-03-05_14-55.png"/></a></figure><h2 id="631eca9a-3d7b-486f-9ec3-855ac18baead" class="">Process Management</h2><p id="88825e08-5bc7-48fd-9973-98c8c516002d" class="">Processes need resources: CPU time, memory etc.</p><p id="aabc19b5-3da6-4978-bcd4-3c92e6bb92a3" class="">The OS manages processes:</p><ul id="2984679d-725f-4522-ab8c-f3b85378495d" class="bulleted-list"><li style="list-style-type:disc">Starts processes</li></ul><ul id="0ca7be22-0a37-404a-af22-43f54673f8c9" class="bulleted-list"><li style="list-style-type:disc">Terminates processes (frees resources)</li></ul><ul id="5e1d3ce8-6691-4340-a01d-d9f10d4a2002" class="bulleted-list"><li style="list-style-type:disc">Controls resource usage (prevents monopolizing CPU time)</li></ul><ul id="38dad272-735b-4b88-a206-ce4f0e454eea" class="bulleted-list"><li style="list-style-type:disc">Schedules CPU time</li></ul><ul id="21da044f-4bdf-4466-be9b-343f3bdbf469" class="bulleted-list"><li style="list-style-type:disc">Synchronizes processes if required</li></ul><ul id="7be501bf-b181-49dc-9efc-6205ab191b8c" class="bulleted-list"><li style="list-style-type:disc">Allows for Inter Process Communication (IPC)</li></ul><h2 id="766ed0a7-82e8-49af-bf66-cce9ae3db8bc" class="">Process Control Block (PCB)</h2><p id="513d6a21-e542-4dba-a60e-e8777baaf14d" class="">Each process has a process control block, which contains the whole process context:</p><div id="5399cc97-9a5a-4482-ad75-ac0564388c77" class="column-list"><div id="9874aeed-37e0-4e68-b119-6eda06fb4a0b" style="width:56.25%" class="column"><figure id="0df98d84-e7ce-465a-8198-b608b2f13071" class="image"><a href="Threads%20and%20Synchronization%208eed6a728f094eb6ab3696275989e0c2/2022-03-05_14-58.png"><img style="width:1104px" src="Threads%20and%20Synchronization%208eed6a728f094eb6ab3696275989e0c2/2022-03-05_14-58.png"/></a></figure></div><div id="0482c3be-bd43-4df4-be69-12112f275fdd" style="width:43.74999999999999%" class="column"><figure id="f8ca5af6-ba20-41fd-bd81-68abf6459c9a" class="image"><a href="Threads%20and%20Synchronization%208eed6a728f094eb6ab3696275989e0c2/2022-03-05_14-59.png"><img style="width:912px" src="Threads%20and%20Synchronization%208eed6a728f094eb6ab3696275989e0c2/2022-03-05_14-59.png"/></a></figure></div></div><h1 id="37b6a614-3820-4225-896f-6751d829f975" class="">Threads/Multithreading</h1><p id="6e4da462-5c0e-4ea7-bb44-f73a447d8429" class="">Threads are independent sequences of execution running in the same OS process. Multiple threads share the same address space. Therefore threads are not shielded from each other, share resources and can communicate more easily. However, this makes multithreading more vulnerable for programming mistakes.</p><p id="619d9833-6ed1-4212-9648-244efdb65cf7" class="">Context switching between threads is efficient, as there is no change of address space, no automatic scheduling and no saving/reloading of the PCB state.</p><p id="fb675afd-e786-405a-a6ad-a1202bc8d658" class="">Multithreading is used in reactive systems - systems that are constantly monitoring. It makes GUI applications more responsive to user input as an application can interrupt a time-consuming task. With multithreading, webservers can handle multiple clients simultaneously. Multithreading in general takes advantage of multiple CPUs/cores.</p><h2 id="742f2b01-7250-475e-82f6-fc76606b101b" class="">Multithreading: 1 vs. many CPUs</h2><figure id="d0189fec-b75c-44e7-a526-fe55040ab628" class="image"><a href="Threads%20and%20Synchronization%208eed6a728f094eb6ab3696275989e0c2/2022-03-05_15-07.png"><img style="width:1248px" src="Threads%20and%20Synchronization%208eed6a728f094eb6ab3696275989e0c2/2022-03-05_15-07.png"/></a></figure><h2 id="a29269bb-4497-4780-bbf7-f7b22ded06be" class="">Java Threads</h2><p id="68fed4d7-a62d-47c3-be12-7cd8ee6327bb" class="">Thread:</p><ul id="d4c33192-26d8-4d18-82e6-3df34666c19a" class="bulleted-list"><li style="list-style-type:disc">A set of instructions to be executed one at a time, in a specified order</li></ul><ul id="be576a9b-4ff6-4962-96bb-630b02bc7e71" class="bulleted-list"><li style="list-style-type:disc">A special <code>Thead</code> class is part of the core language</li></ul><p id="d0f67165-62e5-4b40-94fe-2b83dafe714f" class="">Some methods of <code>java.lang.Thread</code>:</p><ul id="ae2c8b36-2702-44c8-ba55-e929e8e471d6" class="bulleted-list"><li style="list-style-type:disc"><code>start()</code>: method called to spawn a new thread<ul id="8602964c-8851-464d-a0ea-862b1102145a" class="bulleted-list"><li style="list-style-type:circle">Causes JVM to call <code>run()</code> method on object</li></ul></li></ul><ul id="1bba81d1-9b1b-4128-b213-fe33bc62e5a8" class="bulleted-list"><li style="list-style-type:disc"><code>interrupt()</code>: freeze and throw exception to thread</li></ul><h3 id="d35a19e4-e368-4da9-82b7-618686e939ac" class="">Creating Java Threads</h3><p id="3ab6768d-fe88-4b7f-bd1d-1188137ee7b7" class=""><strong>Instantiating a subclass of </strong><code><strong>java.lang.Thread</strong></code><strong>:</strong></p><ul id="b3214f2c-f756-4d00-a631-29afb5e9486d" class="bulleted-list"><li style="list-style-type:disc">Override <code>run()</code> method (must be overridden)</li></ul><ul id="d05a1020-7b38-4144-b0b9-13ccc627dde9" class="bulleted-list"><li style="list-style-type:disc"><code>run()</code> is called when execution of that thread begins</li></ul><ul id="3032ce7d-739e-43ef-862f-2498d6abbdb8" class="bulleted-list"><li style="list-style-type:disc">A thread terminates when <code>run()</code> returns</li></ul><ul id="3f2b6084-bb52-41f2-a613-0b62cfebb748" class="bulleted-list"><li style="list-style-type:disc"><code>start()</code> method invokes <code>run()</code></li></ul><ul id="0427d74b-ad43-4eee-9c1b-75fbca820cc9" class="bulleted-list"><li style="list-style-type:disc">Calling <code>run()</code> does not create a new thread</li></ul><p id="f38fa2ec-eb69-4d83-93ee-504232166e69" class=""><strong>Implement </strong><code><strong><strong>java.lang.Runnable</strong></strong></code><strong><strong>:</strong></strong></p><ul id="4a912693-9f20-45a2-9b66-31ce9b505eba" class="bulleted-list"><li style="list-style-type:disc">Single method: <code>public void run()</code></li></ul><ul id="1c602c02-1a43-49e7-b1cd-299d87e0c041" class="bulleted-list"><li style="list-style-type:disc">Class implements <code>Runnable</code></li></ul><h3 id="d8e8760f-f49d-444d-a07a-68deb79b240e" class="">Thread State Model in Java</h3><figure id="2f361947-3d5f-499b-9686-6d78b7962d14" class="image"><a href="Threads%20and%20Synchronization%208eed6a728f094eb6ab3696275989e0c2/2022-03-05_15-15_1.png"><img style="width:1056px" src="Threads%20and%20Synchronization%208eed6a728f094eb6ab3696275989e0c2/2022-03-05_15-15_1.png"/></a></figure><h3 id="a9f7b55a-5852-4eec-ab3c-2230c648f64c" class=""><code>java.lang.Thread</code> (under the hood)</h3><div id="6c1da6e5-b540-4f08-8dde-410fcd730cab" class="column-list"><div id="fe27f538-eb87-420f-8f87-f19d4585111a" style="width:50%" class="column"><figure id="d5602d00-b930-4717-b03c-d374c10f8b55" class="image"><a href="Threads%20and%20Synchronization%208eed6a728f094eb6ab3696275989e0c2/2022-03-05_15-17.png"><img style="width:1152px" src="Threads%20and%20Synchronization%208eed6a728f094eb6ab3696275989e0c2/2022-03-05_15-17.png"/></a></figure></div><div id="bbb280bc-9bdc-4f46-9b05-b61e0d82e25d" style="width:50%" class="column"><figure id="709e3649-04a5-4c51-ba4c-14b875a60202" class="image"><a href="Threads%20and%20Synchronization%208eed6a728f094eb6ab3696275989e0c2/2022-03-05_15-18.png"><img style="width:1223px" src="Threads%20and%20Synchronization%208eed6a728f094eb6ab3696275989e0c2/2022-03-05_15-18.png"/></a></figure></div></div><h3 id="10f88e42-01a1-45cc-abb3-4ee0b05c4ca2" class="">Java Threads: Some Key Points</h3><ul id="a7b50cda-77f5-41d1-9c7e-d3e55fe0ec2a" class="bulleted-list"><li style="list-style-type:disc">Every Java program has at least one execution thread<ul id="4f50d863-ac69-4542-b479-affba15f696c" class="bulleted-list"><li style="list-style-type:circle">First execution thread calls <code>main()</code></li></ul></li></ul><ul id="bc1e375d-54bf-4b2d-a906-101f8f675a37" class="bulleted-list"><li style="list-style-type:disc">Each call to <code>start()</code> method of a <code>Thread</code> object creates an actual execution thread</li></ul><ul id="07ef02cc-c061-40e0-b3ee-ee4c17163850" class="bulleted-list"><li style="list-style-type:disc">The program end when all non-daemon thread are finished</li></ul><ul id="5b62f4d8-33e3-4805-8fc5-dd902cc72e4b" class="bulleted-list"><li style="list-style-type:disc">Threads can continue to run even if <code>main()</code> returns</li></ul><ul id="4cbf095b-4e07-42e6-9f62-9a0cc4209790" class="bulleted-list"><li style="list-style-type:disc">Creating a <code>Thread</code> object does not start a thread</li></ul><ul id="9475618c-35a4-4d40-afa0-1c2c2f46f0ba" class="bulleted-list"><li style="list-style-type:disc">Calling <code>run()</code> does not start a thread either, need to explicitly call <code>start()</code></li></ul><h3 id="1d4cc540-344a-4843-9bcf-4cc3cd49e60c" class="">Java Threads: Some Useful Attributes and Methods</h3><ul id="73bd7fa0-47a2-4e4d-b2f1-a3f313d9b8aa" class="bulleted-list"><li style="list-style-type:disc"><strong>ID</strong>: this attribute denotes the unique identifier for each <code>Thread</code><pre id="d4d94387-acd5-4d13-a3ec-8e749cabafff" class="code"><code>Thread t = Thread.currentThread();
System.out.println(&quot;Thread ID&quot; + t.getId());</code></pre></li></ul><ul id="390f3a18-036e-4412-b63b-3d269d04a7ac" class="bulleted-list"><li style="list-style-type:disc"><strong>Name</strong>: this attribute denotes the name of the <code>Thread</code><pre id="191443bf-1ded-4495-9ad4-dbbd606e2e5e" class="code"><code>t.setName(&quot;PP&quot; + 2022);</code></pre></li></ul><ul id="83641497-ed4d-4853-825f-bd62521048a5" class="bulleted-list"><li style="list-style-type:disc"><strong>Priority</strong>: denotes the priority of the thread. Threads can have a priority between 1 and 10:<ul id="e798f8f7-c1d6-4262-8f3a-b7cb1e967c9d" class="bulleted-list"><li style="list-style-type:circle">JVM uses the priority of threads to select the one that uses the CPU at each moment</li></ul><ul id="de583796-0f48-4228-b0fb-a739db805a51" class="bulleted-list"><li style="list-style-type:circle">Typically higher-priority threads finish before low-priority threads</li></ul><pre id="365c16bf-7b59-4344-8cc7-84650bf5b9bc" class="code"><code>t.setPriority(Thread.MAX_PRIORITY);</code></pre></li></ul><ul id="f6accd14-f2b0-4d66-a9d4-8c0938097f77" class="bulleted-list"><li style="list-style-type:disc"><strong>Status</strong>: denotes the status the thread is in: one of new, runnable, blocked, waiting, time waiting or terminated<pre id="49a04f6f-47aa-4f9b-a0e4-7b920d3750c7" class="code"><code>if (t.getState() == State.TERMINATED) {
    System.out.println(&quot;Thread is terminated&quot;);
}</code></pre></li></ul><h3 id="40cdece0-0e24-433b-bfc4-33090f196f16" class="">Joining Java Threads</h3><p id="e6595818-5f6d-4517-918b-2f2a4239ff7a" class="">Common scenario:</p><ul id="3fb85524-bf2b-4c36-847f-d41d7c2bedf7" class="bulleted-list"><li style="list-style-type:disc">Main thread starts (forks, spawns) several worker threads...</li></ul><ul id="28f9d6d5-c2c1-473c-9b05-317a14e52be4" class="bulleted-list"><li style="list-style-type:disc">... then needs to wait for the worker’s results to be available</li></ul><p id="44834706-6700-4d43-af12-0b0e051e541a" class="">Previously:</p><ul id="b613d643-6268-41ce-8b16-dcc707cfbb90" class="bulleted-list"><li style="list-style-type:disc">Busy waiting by <em>spinning</em> (looping) until each worker’s state is terminated</li></ul><ul id="199528bb-4329-4385-8c17-8287e80af91b" class="bulleted-list"><li style="list-style-type:disc">Boilerplate code, that is inefficient as the main thread spinning uses CPU time</li></ul><p id="b17567ae-9ef3-40a1-a4fa-c2e9a785d43a" class="">Idea: wake thread up once work is done. From main thread’s perspective:</p><ul id="cd66015d-ccb5-4184-98a0-adf4d4c4ee14" class="bulleted-list"><li style="list-style-type:disc">Instead of busily waiting for the results (ready? now ready? now?)...</li></ul><ul id="39359618-c93b-4713-8854-20204981b68f" class="bulleted-list"><li style="list-style-type:disc">... go to sleep and be woken up once the results are ready</li></ul><p id="6da3707a-5f55-4e32-bce1-6ce4317f0d38" class="">Performance trade-off:</p><ul id="47506059-4e00-4fed-aea0-077207cbf0f2" class="bulleted-list"><li style="list-style-type:disc">Join (sleep, wakeup) typically incurs context switch overhead</li></ul><ul id="0574aeb0-7e2b-4c74-99e6-8ebb74eb01b5" class="bulleted-list"><li style="list-style-type:disc">If worker threads are short-lived, busy waiting may perform better</li></ul><ul id="56f67b0c-becf-4bb4-9018-2a55efbae068" class="bulleted-list"><li style="list-style-type:disc">Later in the course: <code>SpinLock</code></li></ul><h3 id="6046aca0-1c44-45e6-90d8-fcee28394e41" class="">Exceptions</h3><p id="cfeacffe-f385-4b97-8a87-464202096441" class="">Exceptions in a single-threaded (i.e., sequential) program terminate the program if not caught.</p><p id="d4439f44-abb1-4ba6-9a5a-f8bebd77e56d" class="">What if a worker thread throws an exception?</p><ul id="634d52a3-06e1-40d6-a5ff-7ea0d5eda011" class="bulleted-list"><li style="list-style-type:disc">Exception is (usually) shown on console</li></ul><ul id="eadf5c00-436c-4226-877e-755f0ed54cc1" class="bulleted-list"><li style="list-style-type:disc">Behavior of <code>thread.join()</code> is unaffected</li></ul><ul id="0fc4f634-ee4e-4a8a-a60a-764947a0e5be" class="bulleted-list"><li style="list-style-type:disc">Main thread may not be aware of an exception inside a worker thread</li></ul><p id="705f2e8d-68da-4fc7-a043-af0bd81e55d1" class="">Solution: Setting <code>UncaughtExceptionHandler</code>. Implementing <code>UncaughtExceptionHandler</code> interface allows us to handle unchecked exceptions. We have three options:</p><ul id="9d7d64a8-884a-48f9-aecd-486e7c49269e" class="bulleted-list"><li style="list-style-type:disc">Register exception handler with <code>Thread</code> object</li></ul><ul id="cd912c0d-8c1a-46ad-aebd-b14845c3b9cc" class="bulleted-list"><li style="list-style-type:disc">Register exception handler with <code>ThreadGroup</code> object</li></ul><ul id="ca6e6df0-0b58-4caa-addf-5cb21044a35f" class="bulleted-list"><li style="list-style-type:disc">Use <code>setDefaultUncaughtExceptionHandler()</code> to register handler for all threads</li></ul><p id="519ab086-7330-4ad5-b285-687375fee4ad" class="">The exception handler can then record which threads terminated exceptionally, restart them or handle the issue otherwise.</p><p id="1d8b90fb-8dcc-4121-80ff-55ade35ecde3" class="">
</p></div></article></body></html>